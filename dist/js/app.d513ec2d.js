(function(t){function e(e){for(var a,r,c=e[0],o=e[1],l=e[2],d=0,f=[];d<c.length;d++)r=c[d],s[r]&&f.push(s[r][0]),s[r]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a]);u&&u(e);while(f.length)f.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,c=1;c<n.length;c++){var o=n[c];0!==s[o]&&(a=!1)}a&&(i.splice(e--,1),t=r(r.s=n[0]))}return t}var a={},s={app:0},i=[];function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var u=o;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0d19":function(t,e,n){},3186:function(t,e,n){"use strict";var a=n("5059"),s=n.n(a);s.a},5059:function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("6b54"),n("cadf"),n("551c"),n("f751"),n("097d");var a=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("hidden",{staticClass:"hidden-tools"}),n("router-view")],1)},i=[],r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tools",on:{click:t.click}})},c=[],o=(n("7f7f"),function(t){return t.indexOf("fake")>=0}),l={name:"Hidden",methods:{click:function(){this.$route.name&&!o(this.$route.name)?confirm("back or reload?")?this.$router.back():window.location.reload(!0):this.$router.back()}}},u=l,d=(n("cd62"),n("2877")),f=Object(d["a"])(u,r,c,!1,null,"07fdf6b3",null),h=f.exports,v={name:"App",components:{Hidden:h}},p=v,m=(n("7faf"),Object(d["a"])(p,s,i,!1,null,null,null)),g=m.exports,b=n("8c4f"),C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper"},[n("div",{staticClass:"flex-1"}),n("div",{staticClass:"center"},[n("div",{staticClass:"label"},[t._v("输入观察对象的昵称")]),n("input",{staticClass:"input",on:{input:t.handleChange}}),n("div",{staticClass:"btns",class:{show:t.valid}},[n("div",{staticClass:"next",on:{click:t.handleNext}},[t.sending?n("fa",{staticClass:"sp",style:{color:"#6A7A9E"},attrs:{icon:"spinner"}}):n("span",[t._v("完成")])],1)])]),n("div",{staticClass:"flex-1"})])},_=[],w={name:"Create",data:function(){return{valid:!1,value:"",sending:!1}},methods:{handleNext:function(){var t=this;this.valid&&!this.sending&&(this.sending=!0,this.$service.createTarget(this.value).then(function(e){t.sending=!1,t.$router.push("bind")}).catch(function(e){t.sending=!1,t.$router.push("bind")}))},handleChange:function(t){var e=t.target.value;e?(this.valid=!0,this.value=e):this.valid=!1}}},y=w,x=(n("7264"),Object(d["a"])(y,C,_,!1,null,"74690ae6",null)),k=x.exports,O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper"},[a("div",{staticClass:"flex-1"}),a("div",{staticClass:"center"},[a("div",{staticClass:"icons"},[a("img",{staticClass:"icon-1",class:{active:t.wbEnabled},attrs:{src:n("acec")}}),a("img",{staticClass:"icon-2",class:{active:t.nmEnabled},attrs:{src:n("95ae")}}),a("img",{staticClass:"icon-3",class:{active:t.dbEnabled},attrs:{src:n("5ad2")}})]),a("div",{staticClass:"input-area"},[a("div",{staticClass:"label"},[t._v("确定你的观察范围")]),a("input",{ref:"input",staticClass:"input",attrs:{placeholder:t.placeholder},on:{input:t.handleChange}})]),a("div",{staticClass:"btns"},[a("div",{staticClass:"next",on:{click:t.handleBind}},[t.loading?a("fa",{staticClass:"sp",style:{color:"#6A7A9E"},attrs:{icon:"spinner"}}):a("span",[t._v("绑定")])],1),a("div",{staticClass:"next",on:{click:t.handleNext}},[t._v("完成")])])]),a("div",{staticClass:"flex-1"})])},j=[],$={name:"Bind",data:function(){return{enabled:[],value:"",placeholder:"复制以上任意平台的主页链接",loading:!1}},computed:{wbEnabled:function(){return this.enabled.indexOf("Weibo")>=0},nmEnabled:function(){return this.enabled.indexOf("NeteaseMusic")>=0},dbEnabled:function(){return this.enabled.indexOf("Douban")>=0}},methods:{handleChange:function(t){var e=t.target.value;e?(this.valid=!0,this.value=e):this.valid=!1},handleBind:function(){var t=this;this.loading||(this.loading=!0,this.$service.bind(this.value).then(function(e){t.enabled=e.data.updateSources.map(function(t){return t.external}),t.value="",t.loading=!1,t.$refs.input.value="",t.$toast("绑定成功",2e3,"none")}).catch(function(e){t.$toast(e,2e3,"none"),t.loading=!1}))},handleNext:function(){this.$router.push("main")}},mounted:function(){}},E=$,T=(n("a64a"),Object(d["a"])(E,O,j,!1,null,"79e9bfa4",null)),M=T.exports,P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper"},[n("div",{staticClass:"inner-wrapper"},[n("div",{staticClass:"top"},[n("div",{staticClass:"tool"},[n("fa",{staticClass:"setting",style:{color:"white"},attrs:{icon:"cog"}})],1),n("div",{staticClass:"user"},[n("img",{staticClass:"avatar",attrs:{src:t.profile.avatarUrl}}),n("div",{staticClass:"nickname"},[n("div",{staticClass:"name"},[t._v(t._s(t.profile.name))]),n("fa",{staticClass:"gender",class:{male:!0},attrs:{icon:"mars"}})],1),n("div",{staticClass:"desc"},[t._v(t._s("有0个人和你一样在看他"))]),t.sources.length?n("div",{staticClass:"tags"},t._l(t.sources,function(t){return n("tag",{attrs:{k:t.key,v:t.value}})}),1):t._e()])]),n("div",{ref:"scrollList",staticClass:"mid"},[n("fa",{directives:[{name:"show",rawName:"v-show",value:t.chats.length<=0,expression:"chats.length <= 0"}],staticClass:"sp",style:{color:"white"},attrs:{icon:"spinner"}}),t._l(t.chats,function(e,a){return n("chat",{key:e.id,staticClass:"chat",attrs:{chat:e,avatar:t.profile.avatarUrl}})})],2)]),n("chat-bar",{staticClass:"bottom-bar",on:{message:t.handleMessage}})],1)},S=[],A=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tag"},[n("span",[t._v(t._s(t.k+": "+t.v))])])},N=[],D={name:"Tag",props:{k:String,v:String}},B=D,U=(n("3186"),Object(d["a"])(B,A,N,!1,null,"e41af2f2",null)),L=U.exports,F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bar"},[n("transition",{attrs:{name:"fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.showMenu,expression:"showMenu"}],staticClass:"list"},[n("div",{staticClass:"item",on:{click:function(e){return t.to("member")}}},[n("fa",{style:{color:"white"},attrs:{icon:"id-badge"}})],1),n("div",{staticClass:"item"},[n("fa",{style:{color:"white"},attrs:{icon:"search-plus"}})],1),n("div",{staticClass:"item",on:{click:function(e){return t.to("calendar")}}},[n("fa",{style:{color:"white"},attrs:{icon:"calendar-alt"}})],1),n("div",{staticClass:"item",on:{click:function(e){return t.to("nasa")}}},[n("fa",{style:{color:"white"},attrs:{icon:"rocket"}})],1)])]),n("fa",{staticClass:"menu",style:{color:"white"},attrs:{icon:"bars"},on:{click:t.handleToggleMenu}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],staticClass:"input",attrs:{placeholder:t.pl},domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}}),n("div",{staticClass:"send",on:{click:t.send}},[t.sending?n("fa",{staticClass:"sp",style:{color:"#6A7A9E"},attrs:{icon:"spinner"}}):n("span",[t._v("发送")])],1)],1)},H=[],I={name:"ChatBar",data:function(){return{value:"",promise:null,sending:!1,pl:"",showMenu:!1}},methods:{to:function(t){this.$router.push(t)},handleToggleMenu:function(){this.showMenu=!this.showMenu},send:function(){var t,e,n=this;this.value&&!this.sending&&(this.sending=!0,this.p=new Promise(function(n,a){t=n,e=a}).then(function(){n.sending=!1,n.value=""}).catch(function(){n.sending=!1,n.value=""}),console.log("msg:",this.value),this.$emit("message",{value:this.value,res:t,rej:e}))}}},W=I,q=(n("6648"),Object(d["a"])(W,F,H,!1,null,"585c4aa6",null)),J=q.exports,R=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chat-item"},[n("div",{staticClass:"left",class:{hide:t.chat.isSelf}},[n("div",{staticClass:"avatar",style:{backgroundImage:"url("+t.avatar+")"}})]),n("div",{staticClass:"center"},[t.chat.isSelf?t._e():[t.chat.title?n("div",{staticClass:"title"},[t._v(t._s(t.chat.title))]):t._e(),n("div",{staticClass:"subtitle"},[t.chat.actionTime?n("span",[t._v(t._s(t._f("formatPassedTime")(t.chat.actionTime)))]):t._e(),t._v("   "),t.chat.subtitle?n("span",[t._v(t._s(t.chat.subtitle))]):t._e()]),t.chat.music?n("div",{staticClass:"music"},[n("img",{staticClass:"logo",attrs:{src:t.chat.music.albumPicUrl}}),n("div",{staticClass:"song"},[n("div",{staticClass:"name"},[t._v(t._s(t.chat.music.name))]),n("div",{staticClass:"singer"},[t._v(t._s(t.chat.music.author))])])]):t._e()],t.chat.content?n("div",{staticClass:"content"},[t._v(t._s(t.chat.content))]):t._e(),t.chat.picUrls&&t.chat.picUrls.length?n("div",{staticClass:"imgs"},[n("div",{staticClass:"im",style:{backgroundImage:"url("+t.chat.picUrls[0]+")"}})]):t._e(),t.chat.content&&t.chat.isSelf?n("div",{staticClass:"send-time"},[t._v(t._s(t._f("formatTime")(t.chat.actionTime)))]):t._e()],2),n("div",{staticClass:"right",class:{hide:!t.chat.isSelf}},[n("div",{staticClass:"avatar self"})])])},Y=[],z={name:"Chat",props:{avatar:String,chat:{type:Object,default:function(){return{isSelf:!0}}}}},G=z,K=(n("ed3a"),Object(d["a"])(G,R,Y,!1,null,"5b5ed966",null)),Q=K.exports,V={Weibo:"微博",Douban:"豆瓣",NeteaseMusic:"云音乐"},X=function(t){var e,n=t.duration,a=t.draw,s=t.easing,i=function t(i){var r;e?r=i-e>=n?1:Math.max(0,s((i-e)/n)):(e=i,r=0),r>=1?a(1):(a(r),requestAnimationFrame(t))};requestAnimationFrame(i)},Z={name:"Main",components:{Tag:L,ChatBar:J,Chat:Q},data:function(){return{timer:void 0,fetching:!1,chats:[],profile:{},sources:[]}},methods:{handleMessage:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.value,a=e.res,s=e.rej;this.$service.postDiary(n).then(function(e){console.log(e),a(),t.fetch(!0)}).catch(function(e){s(),t.$toast(e,2e3,"none")})},fetch:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];console.log("fetch once"),this.$service.fetchList().then(function(n){var a=!1;n.data.data&&n.data.data.length&&(a=e&&t.chats.length!==n.data.data.length,t.chats=n.data.data.reverse()),a&&t.$nextTick(function(){X({draw:function(){var e=t.$refs.scrollList,n=e.scrollTop,a=e.scrollHeight-e.getBoundingClientRect().height,s=Math.max(a-n,0);return function(t){e.scrollTo(0,n+s*t)}}(),duration:1e3,easing:function(t){return t*t}})})}).catch(function(e){t.$toast(e,2e3,"none")})},init:function(){var t=this;this.$service.fetchTarget().then(function(e){console.log("profile:",e.data);var n=e.data,a=n.profile,s=n.updateSources;t.profile=a,s.length&&(t.sources=s.map(function(t){var e,n;return t.external in V&&(e=V[t.external],n=t.name),{key:e,value:n}}))})}},mounted:function(){var t=this;this.init(),this.fetch(!0),this.timer=setInterval(function(){t.fetching||t.fetch()},1e4)},destroyed:function(){clearInterval(this.timer)}},tt=Z,et=(n("9e48"),Object(d["a"])(tt,P,S,!1,null,"0b7632b2",null)),nt=et.exports,at=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper"})},st=[],it=(n("948c"),{}),rt=Object(d["a"])(it,at,st,!1,null,"35246416",null),ct=rt.exports,ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper"})},lt=[],ut=(n("85b6"),{}),dt=Object(d["a"])(ut,ot,lt,!1,null,"1f80e78d",null),ft=dt.exports,ht=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper"})},vt=[],pt=(n("728d"),{}),mt=Object(d["a"])(pt,ht,vt,!1,null,"5e6e2b8a",null),gt=mt.exports;a["default"].use(b["a"]);var bt=new b["a"]({routes:[{path:"/",name:"create",component:k},{path:"/bind",name:"bind",component:M},{path:"/main",name:"main",component:nt},{path:"/nasa",name:"fake-nasa",component:ct},{path:"/member",name:"fake-member",component:gt},{path:"/calendar",name:"fake-calendar",component:ft}]}),Ct=n("2f62");a["default"].use(Ct["a"]);var _t,wt=new Ct["a"].Store({state:{},mutations:{},actions:{}}),yt=n("9483"),xt=function(t){confirm("update detected!")&&t.postMessage({action:"skipWaiting"})};Object(yt["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(t){console.log("New content is available; please refresh."),xt(t.waiting)},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}}),navigator.serviceWorker.addEventListener("controllerchange",function(){_t||(window.location.reload(!0),_t=!0)});var kt=n("ecee"),Ot=n("c074"),jt=n("ad3d"),$t=n("fe41"),Et=n.n($t),Tt=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),Mt=n("bc3a"),Pt=n.n(Mt);function St(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)}return n}function At(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?St(n,!0).forEach(function(e){Object(Tt["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):St(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var Nt=function(t){if(t.response)throw t},Dt="https://4247092b.ngrok.io/",Bt=Pt.a.create({baseURL:Dt});Bt.interceptors.response.use(function(t){return t},Nt);var Ut={createTarget:function(t){return Bt.post("/target/create",{name:t})},fetchTarget:function(t){return Bt.post("/target/detail")},postDiary:function(t){return Bt.post("/diary/post",{content:t})},updateTarget:function(t){return Bt.post("/target/updateProfile",At({},t))},bind:function(t){return Bt.post("/target/bindExternal",{identifier:t})},fetchList:function(){return Bt.post("/update/list")}},Lt={install:function(t){t.prototype.$service=Ut,t.prototype.$toast=Et.a}},Ft=function t(e,n){return e=e.toString(),e.length<n?t("0"+e,n):e},Ht=86400,It=3600,Wt=60,qt=function(t){if(!t||t<=0)return"";var e=~~(t/1e3),n=~~(e/Ht),a=~~(e%Ht/It),s=~~(e%It/Wt),i=~~(e%Wt);return{day:n,hour:a,min:s,second:i}},Jt=function(t){return function(e){return t(qt(e))}},Rt=Jt(function(t){var e=t.day,n=t.hour,a=t.min;return e>0?"".concat(e,"天前"):n>0?"".concat(n,"小时前"):a>0?"".concat(a,"分钟前"):"刚才"});kt["c"].add(Ot["j"],Ot["d"],Ot["a"],Ot["e"],Ot["i"],Ot["b"],Ot["h"],Ot["f"],Ot["k"],Ot["c"],Ot["g"]),a["default"].component("fa",jt["a"]),a["default"].filter("formatPassedTime",Rt),a["default"].filter("formatTime",function(t){var e=new Date(t);return"".concat(e.getFullYear(),"年").concat(e.getMonth()+1,"月").concat(e.getDate(),"日 ").concat(Ft(e.getHours(),2),":").concat(Ft(e.getMinutes(),2))}),a["default"].use(Lt),a["default"].config.productionTip=!1,new a["default"]({router:bt,store:wt,render:function(t){return t(g)}}).$mount("#app")},"5ad2":function(t,e,n){t.exports=n.p+"img/icon-db.7bcfe656.png"},"5ed0":function(t,e,n){},6648:function(t,e,n){"use strict";var a=n("820d"),s=n.n(a);s.a},"6be9":function(t,e,n){},7264:function(t,e,n){"use strict";var a=n("0d19"),s=n.n(a);s.a},"728d":function(t,e,n){"use strict";var a=n("fab8"),s=n.n(a);s.a},"79da":function(t,e,n){},"7faf":function(t,e,n){"use strict";var a=n("8fba"),s=n.n(a);s.a},"820d":function(t,e,n){},"85b6":function(t,e,n){"use strict";var a=n("79da"),s=n.n(a);s.a},"8fba":function(t,e,n){},"948c":function(t,e,n){"use strict";var a=n("acbf"),s=n.n(a);s.a},"95ae":function(t,e,n){t.exports=n.p+"img/icon-nm.e833cb5e.png"},"9e48":function(t,e,n){"use strict";var a=n("d474"),s=n.n(a);s.a},a64a:function(t,e,n){"use strict";var a=n("cd4a"),s=n.n(a);s.a},acbf:function(t,e,n){},acec:function(t,e,n){t.exports=n.p+"img/icon-wb.3aaaa513.png"},cd4a:function(t,e,n){},cd62:function(t,e,n){"use strict";var a=n("6be9"),s=n.n(a);s.a},d474:function(t,e,n){},ed3a:function(t,e,n){"use strict";var a=n("5ed0"),s=n.n(a);s.a},fab8:function(t,e,n){}});
//# sourceMappingURL=app.d513ec2d.js.map